{"changed":false,"filter":false,"title":"signup.inc.php","tooltip":"/includes/signup.inc.php","value":"<?php\n\nif(isset($_POST['submit'])){\n    \n    include_once 'dbh.inc.php';\n    \n    $username = mysqli_real_escape_string($conn, $_POST['name']);\n    $email = mysqli_real_escape_string($conn, $_POST['email']);\n    $pwd = mysqli_real_escape_string($conn, $_POST['pwd']);\n    \n    //Error handlers\n    //Check for empty fields\n    if(empty($username) || empty($email) || empty($pwd)){\n        header(\"Location: ../index.php?signup=empty\");\n        exit();\n    }else{\n        //Check if input characters are valid\n        if(!preg_match(\"/^[a-z A-Z]*$/\", $username)){\n            header(\"Location: ../index.php?signup=invalid\");\n            exit();\n        }else{\n            //Check if email is valid\n            if(!filter_var($email, FILTER_VALIDATE_EMAIL)){\n                header(\"Location: ../index.php?signup=email\");\n                exit();\n            }else{\n                $sql = \"SELECT * FROM users WHERE user_name = '$username'\";\n                $result = mysql_query($conn, $sql);\n                $resultCheck = mysql_num_rows($result);\n                \n                if($resultCheck > 0){\n                    header(\"Location: ../index.php?signup=usertaken\");\n                    exit();\n                } else {\n                    $hashedPwd = password_hash($pwd, PASSWORD_DEFAULT);\n                    //Insert the user into the database\n                    $sql = \"INSERT INTO users (user_name, user_email, user_pwd) VALUES ('$username', '$email', '$hashedPwd');\";\n                    mysqli_query($conn, $sql);\n                    header(\"Location: ../index.php?signup=success\");\n                    exit();\n                }\n            }\n        }\n    }\n}else{\n    header(\"Location: ../index.php\");\n    exit();\n}\n?>","undoManager":{"mark":-1,"position":-1,"stack":[]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":2,"column":22},"end":{"row":2,"column":22},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1537977324370}